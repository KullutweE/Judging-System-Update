<!DOCTYPE HTML>
<html lang="eng">
	<head>
		<title>Apply</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="../assets/css/main.css" />	
		<link rel="stylesheet" href="../assets/css/logo.css" />
		<link rel="stylesheet" href="../assets/css/nav.css" />
		<link rel="stylesheet" href="./assets/css/error.css">	
		<link rel="stylesheet" href="http://www.ium.edu.na/css/searchstyle.css">
		<link rel="stylesheet" href="http://www.ium.edu.na/css/PhotoGallery.css">	
		<link rel="stylesheet" href="http://www.ium.edu.na/css/custom.css">
		<noscript><link rel="stylesheet" href="../assets/css/noscript.css" /></noscript>
		<script src="./gen_validatorv4.js" type="text/javascript"></script>

		
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<script type="text/javascript">
(function() {
emailjs.init("user_hSllDtQDEE19eycMrR59U");
})();
</script>

	</head>
	<div class="jumbotron top-jumbotron ">

		<div class="container-fluid">
		
		  <div class= "row">
			<div class="col-xs-6 col-md-2 col-lg-2">
		
			<!-- <div class="image fit"> -->
		
			  <a href="#"><img src="http://www.ium.edu.na/image/IUM new Logo.png" alt="IUM logo" class="img-responsive"></a>
		
			</div>
		
		  </div>
		  </div>
		  </div>

		  
		 <nav class="navbar navbar-default navbar-static-top affix" data-spy="affix" data-offset-top="197">

			<div class="container-fluid">
	  
			  <div class="navbar-header">
	  
				<span class="navbar-brand hidden-md hidden-lg" href="#">
	
				</span>
	  
			  </div>

				<ul class="nav navbar-nav nav-pills">
	  

					<li><a href="/public/index.html#one">Welcome</a></li>
		
					<li class="divider"></li>

					<li><a href="/public/index.html#two">About Developer</a></li>
				   
					<li class="divider"></li>
	
					<li><a href="/public/index.html#three">How it works</a></li>
	
					<li class="divider"></li>
	
					<li><a href="/public/index.html#four">Get in touch</a></li>

					<li class="divider"></li>

					<li><a href="/public/index.html#five">Apply/Sign in</a></li>
	
					</ul>
					</div>
					</nav>
					</div>


	<body class="is-preload">
		<section id="body" style="background-color: #123661;">

			<section id="five">
				<div style="background-color: #123661;" class="container">
					<section>
						<a href="/public/index.html"><span class="icon solid fa-arrow-left"></span></a>
						<h4 style="font-weight: bolder; color:white">Contestant application</h4>
						<div class="container">
							<form id="form" class="form">
								<!--Name-->

								<div class="form-control">
									<label for="fname">First Name</label>
									<input type="text" name="fname" id="fname"  placeholder="Name" />
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>
								<div class="form-control">
									<label for="surname">Last Name</label>
									<input type="text" name="surname" id="surname"  placeholder="Surname" />
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>	
								<div class="form-control">
									<label for="email">Email</label>
									<input type="email" placeholder="a@florin-pop.com" id="email" />
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>
								<div class="form-control">
									<label for="studentNr">Student Number</label>
									<input type="text" name="studentNr" id="studentNr"  placeholder="Student Number" size="9" />
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>	
								<div class="form-control">
									<label for="studyYear">Study Year</label>
									<select name="studyYear" id="studyYear">
										<option value="DefaultYr">- study Year -</option>
										<option value="1">1</option>
										<option value="2">2</option>
										<option value="3">3</option>
										<option value="4th or beyond">4th or beyond</option>
									</select>
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>	
								<div class="form-control">
									<label for="cell">Contact Number</label>
									<input type="text" name="cell" id="cell"  placeholder="Cellphone Number" />
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>	
								<div class="form-control">
									<label for="nationality">Nationality</label>
									<select name="nationality" id="nationality" >
										<option value="Default">- Nationality -</option>
										<option value="Namibia">Namibia</option>
										<option value="Angola">Angola</option>
										<option value="South Africa">South Africa</option>
										<option value="Zambia">Zambia</option>
										<option value="Zimbabwe">Zimbabwe</option>
										<option value="Congo">Congo</option>
										<option value="Others">Others</option>
									</select>
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>	
								<div class="form-control">
									<label for="hobbies">Hobby</label>
									<input type="text" name="hobbies" id="hobbies"  placeholder="Hobbies" />
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>	
								<div class="form-control">
									<label for="Age">Contestant Age</label>
									<select name="Age" id="Age" >
										<option value="Defaultage">- Age -</option>
										<option value="-15">-15</option>
										<option value="16">16</option>
										<option value="17">17</option>
										<option value="18">18</option>
										<option value="19">19</option>
										<option value="20">20</option>
										<option value="21">21</option>
										<option value="22">22</option>
										<option value="23">23</option>
										<option value="24">24</option>
										<option value="25">25</option>
										<option value="26">26</option>
										<option value="+27">+27</option>
									</select>
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>	
								<div class="form-control">
									<label for="studyProgram">Study Program</label>
									<input type="text" name="studyProgram" id="studyProgram"  placeholder="Study Program" />
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>	
								<div class="form-control">
									<label for="campus">Campus</label>
									<select name="campus" id="campus" >
										<option value="Defaultcamp">- Campus -</option>
										<option value="Dorado Park Campus (Windhoek)">Dorado Park Campus (Windhoek)</option>
										<option value="City Campus (Windhoek)">City Campus (Windhoek)</option>
										<option value="Ongwediva Campus">Ongwediva Campus</option>
										<option value="Nkurenkuru Campus">Nkurenkuru Campus</option>
										<option value="Walvis Bay Campus">Walvis Bay Campus</option>
										<option value="Swakopmund Campus">Swakopmund Campus</option>
									</select>
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>	
								<div class="form-control">
									<label for="gender">Gender</label>
									<select name="gender" id="gender" >
										<option value="DefaultGender">- Gender -</option>
										<option value="male">Male</option>
										<option value="female">Female</option>
									</select>
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>	
								<!-- <div class="form-control">
									<label for="Why">Why do you want to be the next Mr / Miss IUM?</label>
									<textarea name="Why" id="Why" placeholder="Why do you want to be the next Mr / Miss IUM?" rows="6"></textarea>
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>	
								<div class="form-control">
									<label for="What">What would you do as the next Mr / Miss Ium?</label>
									<textarea name="What" id="What" placeholder="What would you do as the next Mr / Miss Ium?" rows="6"></textarea>
									<i class="fas fa-check-circle"></i>
									<i class="fas fa-exclamation-circle"></i>
									<small>Error message</small>
								</div>									 -->
								<!--Buttons-->
								<div class="col-12">
									<ul class="actions">
										<button type="submit" id="subappbtn"  class="primary">Apply</button>
										<button type="reset">Reset</button>
									</ul>
								</div>
							</form>
						</div>
					
						
						<!-- <script>
							const form = document.getElementById('applicationform');
							form.addEventListener('submit', e => {
								e.preventDefault();
							
							const fname = document.getElementById('name').value;
							const surname = document.getElementById('surname').value;
							const email = document.getElementById('email').value;
							const studentNr = document.getElementById('studentNr').value;
							const year = document.getElementById('studyYear').value;
							const cell = document.getElementById('cell').value;
							const nat = document.getElementById('nationality').value;
							const hob = document.getElementById('hobbies').value;
							const agey = document.getElementById('Age').value;
							const stdyProg = document.getElementById('studyProgram').value;
							const campus = document.getElementById('campus').value;
							const why = document.getElementById('why').value;
							const what = document.getElementById('what').value;
							const sex = document.getElementById('gender').value;
							const emailRegex = /^[0-9]+@[.campus.ium.edu.na]/;
							//email
							if (!email.value.match(emailRegex)) {
							alert('Invalid email address.');}
							//student nr
							if (studentNr.length < 6 & studentNr.length > 8) {
							alert('Student Nr must be more than 6 and less than 8 characters long')
							}
							//first and last name
							if (fname.value.trim()=="") {
								alert('First name can not be blank')
							}
							if (surname.value.trim()=="") {
								alert('Surname can not be blank')
							}
							//year
							if (year.value=="") {
								alert('Enter Study Year')
							}
							//Cell number
							if (cell.value.trim()=="") {
								alert('Enter cell number')
							}
							// nationality
							if (nat.value=="") {
								alert('Select a nationality')
							}
							//Hobbies
							if (hob.value.trim()=="") {
								alert('Enter your hobbies')
							}
							//age
							if (agey.value=="") {
								alert('Select age')
							}
							//Study Program
							if (stdyProg.value.trim()=="") {
								alert('Enter Study Program')
							}
							//Campus
							if (campus.value=="") {
								alert('Select Campus')
							}
							//gender
							if (sex.value=="") {
								alert('Select Gender')
							}
							//why
							if (why.value.trim()=="") {
								alert('Enter your reason for applying for competition')
							}
							//what
							if (what.value.trim()=="") {
								alert('Enter what you would do if you won')
							}
						});
						</script> -->
						<!-- <script language="JavaScript" type="text/javascript" xml:space="preserve">
							var frmvalidator  = new Validator("applicationform");
							//names
							frmvalidator.addValidation("name","req","Please enter your First Name");
							frmvalidator.addValidation("surname","req","Please enter your Last Name");
							//email
							frmvalidator.addValidation("email","req","Please enter your Email");
							frmvalidator.addValidation("email","email","Please enter valid Email for IUM Students");
							//Student number
							frmvalidator.addValidation("studentNr","req","Please enter your Student Number");
							frmvalidator.addValidation("studentNr","num","Student Number can only consist of numbers");
							frmvalidator.addValidation("studentNr","maxlen=9","Student Number can not be more than 9 digits");
							frmvalidator.addValidation("studentNr","minlen=9","Student Number is invalid");
							//Study year
							frmvalidator.addValidation("studyYear","dontselect=DefaultYr","Please choose your Study Year");
							//cellphone
							frmvalidator.addValidation("cell","req","Please enter your Cellphone Number");
							frmvalidator.addValidation("cell","maxlen=15","Invalid Cellphone number");
							frmvalidator.addValidation("cell","numeric");
							//Nationality
							frmvalidator.addValidation("nationality","dontselect=Default","Please choose your Nationality");
							//Hobbies
							frmvalidator.addValidation("hobbies","req","Please enter your Hobby");
							frmvalidator.addValidation("hobbies","alnum_s","Please enter your Hobbies separated by space if they are more than one");
							//Age
							frmvalidator.addValidation("Age","dontselect=Defaultage","Please choose your age range");
							//Study Program
							frmvalidator.addValidation("studyProgram","req","Please enter your Study Program");
							frmvalidator.addValidation("studyProgram","alpha_s","Study Program name only contain letters");
							//Campus
							frmvalidator.addValidation("campus","dontselect=Defaultcamp","Please choose the campus to which you belong");
							//Gender
							frmvalidator.addValidation("gender","dontselect=DefaultGender","Please choose your Gender");

							//pic vali missing

							//Why
							frmvalidator.addValidation("Why","req","Please tell us why you would like to join");
							frmvalidator.addValidation("Why","maxlen=120","Keep your response to 120 words");
							//What
							frmvalidator.addValidation("What","req","Please tell us what you would do if you win");
							frmvalidator.addValidation("What","maxlen=120","Keep your response to 120 words");
						</script> -->
					</section>
				</div>
			</section>
			<script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-app.js"></script>
			<script src="https://www.gstatic.com/firebasejs/8.9.1/firebase-firestore.js"></script>
		<script>
					// Your web app's Firebase configuration
					const firebaseConfig = {
					apiKey: "AIzaSyBuoID-FVQH3stFpUJhQuKFFjRMQuPKnE0",
					authDomain: "beauty-pageant-judging-system.firebaseapp.com",
					projectId: "beauty-pageant-judging-system",
					storageBucket: "beauty-pageant-judging-system.appspot.com",
					messagingSenderId: "327388870081",
					appId: "1:327388870081:web:7cc2a2ee298114ec4a6b40",
					measurementId: "G-RB3GBY1QL6"
					};
					// Initialize Firebase
					firebase.initializeApp(firebaseConfig);
					const database = firebase.firestore();
					const form = document.getElementById('form');
					const fname = document.getElementById('fname');
					const surname = document.getElementById('surname');
					const email = document.getElementById('email');
					const studentNr = document.getElementById('studentNr');
					const year = document.getElementById('studyYear');
					const cell = document.getElementById('cell');
					const nat = document.getElementById('nationality');
					const hob = document.getElementById('hobbies');
					const agey = document.getElementById('Age');
					const stdyProg = document.getElementById('studyProgram');
					const campus = document.getElementById('campus');
					// const why = document.getElementById('why');
					// const what = document.getElementById('what');
					const sex = document.getElementById('gender');
					const applicationss = database.collection('Applications');


					form.addEventListener('submit', e => {
						e.preventDefault();
						
						checkInputs();
						
					});

					function checkInputs() {
						// trim to remove the whitespaces
						const nameValue = fname.value.trim();
						const emailValue = email.value.trim();
						const surnameValue = surname.value.trim();
						const studentNrValue = studentNr.value.trim();
						const yearValue = year.value.trim();
						const CellphoneValue = cell.value.trim(); 
						const NationalityValue = String(nat.value).trim(); 
						const HobbyValue = hob.value.trim(); 
						const ageValue = agey.value.trim();
						const Study_ProgramValue = stdyProg.value.trim(); 
						const CampusValue = String(campus.value).trim(); 
						const GenderValue = String(sex.value).trim();	
						// const WhyValue = why.value.trim(); 
						// const WhatValue = what.value.trim();
						
						if(true){
						if(nameValue === '') {
							setErrorFor(fname, 'Name cannot be blank');
						} else {
							setSuccessFor(fname);
						}

						if(surnameValue === '') {
							setErrorFor(surname, 'Student Number cannot be blank');
						} else {
							setSuccessFor(surname);
						}

						if(emailValue === '') {
							setErrorFor(email, 'Email cannot be blank');
						} else if (!isEmail(emailValue)) {
							setErrorFor(email, 'Not a valid email');
						} else {
							setSuccessFor(email);
						}

						if(studentNrValue === '') {
							setErrorFor(studentNr, 'Surname cannot be blank');
						} else {
							setSuccessFor(studentNr);
						}

						if(yearValue === 'DefaultYr') {
							setErrorFor(year, 'Study Year cannot be blank');
						} else {
							setSuccessFor(year);
						}

						if(CellphoneValue === '') {
							setErrorFor(cell, 'Cell number cannot be blank');
						} else {
							setSuccessFor(cell);
						}
						
						
					  if(NationalityValue === 'Default') {
							setErrorFor(nat, 'Nationality cannot be blank');
						} else {
							setSuccessFor(nat);
						}

						if(HobbyValue === '') {
							setErrorFor(hob, 'Hobby cannot be blank');
						} else {
							setSuccessFor(hob);
						}

						if(ageValue === 'Defaultage') {
							setErrorFor(agey, 'Age cannot be blank');
						} else {
							setSuccessFor(agey);
						}

						if(Study_ProgramValue === '') {
							setErrorFor(stdyProg, 'Study Program cannot be blank');
						} else {
							setSuccessFor(stdyProg);
						}

						if(CampusValue === 'Defaultcamp') {
							setErrorFor(campus, 'Campus cannot be blank');
						} else {
							setSuccessFor(campus);
						}

						if(GenderValue === 'DefaultGender') {
							setErrorFor(sex, 'Gender cannot be blank');
						} else {
							setSuccessFor(sex);
							return savedata(),sendmail();
						}
					// }
					// 	// if(WhyValue === '') {
					// 	// 	setErrorFor(why, 'Why do you want to be the next Mr / Miss IUM?');
					// 	// } else {
					// 	// 	setSuccessFor(why);
					// 	// }

					// 	// if(WhatValue === '') {
					// 	// 	setErrorFor(what, 'What would you do as the next Mr / Miss Ium?');
					// 	// } else {
					// 	// 	setSuccessFor(what);
					// 	// }
					// 		else if(true){

					}
						
				}
					function savedata(){
						const ID = applicationss.add({
						// contestnum: constNum,
						firstName: fname.value,
						lastName: surname.value,
						email: email.value,
						StudentNr: studentNr.value, 
						Study_year: year.value, 
						Cellphone: cell.value, 
						Nationality: String(nat.value), 
						Hobby: hob.value, 
						Age: Number(agey.value), 
						Study_Program: stdyProg.value, 
						Campus: String(campus.value), 
						// Why: Text(why.value), 
						// What: what.value,
						Gender: String(sex.value),
						Date_Created: Date.now(),     
						// Applicant_Picture: img
					}).then(function() {
						var tempParams={
						to_name:surname.value,
						applicant_email:email.value
						};
						emailjs.send('service_ydqc2pm', 'applicant_form', tempParams)
						.then(function(res) {
						console.log('SUCCESS!', res.status, res.text);
						}, function(error) {
						console.log('FAILED...', error);
						});
						alert("Document successfully written!");
						window.location.replace("/public/index.html");
					})
					.catch(function(error) {
					// The document probably doesn't exist.
					alert("Error writing document: ", error);
					});

					}


					function sendmail(){
						// .then(function() {
						var tempParams={
						to_name:surname.value,
						applicant_email:email.value
						};
						emailjs.send('service_ydqc2pm', 'applicant_form', tempParams)
						.then(function(res) {
						console.log('SUCCESS!', res.status, res.text);
						}, function(error) {
						console.log('FAILED...', error);
						});
					// })
					}
					function setErrorFor(input, message) {
						const formControl = input.parentElement;
						const small = formControl.querySelector('small');
						formControl.className = 'form-control error';
						small.innerText = message;
					}

					function setSuccessFor(input) {
						const formControl = input.parentElement;
						formControl.className = 'form-control success';
					}
						
					function isEmail(email) {
						return /^[0-9]+@[.campus.ium.edu.na]/.test(email);
					}

		</script>

		<!-- Footer -->
			<section id="footer">
				<ul class="icons">
					<li><a href="#" class="icon brands alt fa-twitter"><span class="label">Twitter</span></a></li>
					<li><a href="#" class="icon brands alt fa-facebook-f"><span class="label">Facebook</span></a></li>
					<li><a href="#" class="icon brands alt fa-instagram"><span class="label">Instagram</span></a></li>
					<li><a href="#" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
					<li><a href="#" class="icon solid alt fa-envelope"><span class="label">Email</span></a></li>
				</ul>
				<ul class="copyright">
					<li>&copy; Untitled. All rights reserved.</li><li>Design: <a href="/public/index.html#two">Emilia Kullutwe</a></li>
				</ul>
			</section>




		<!-- Scripts -->
			<!-- <script src="./assets/js/contestReq.js"></script> -->
			<script src="../assets/js/jquery.min.js"></script>
			<script src="../assets/js/jquery.scrolly.min.js"></script>
			<script src="../assets/js/browser.min.js"></script>
			<script src="../assets/js/breakpoints.min.js"></script>
			<script src="../assets/js/util.js"></script>
			<script src="../assets/js/main.js"></script>

	</body>
</html>